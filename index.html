<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Redirect Page</title>
</head>
<body>
    <script>
        // Function to extract parameters from the URL
        function getUrlParams() {
            const params = new URLSearchParams(window.location.search);
            return {
                apartment_id: params.get('apartment_id')
            };
        }

        // Function to make API POST call
        function sendApiPostCall(data) {
            const apiUrl = 'https://events.sendpulse.com/events/id/4095f77f048e4252adb2c73767e22fda/8468664';

            // Make a POST request using Fetch API
            fetch(apiUrl, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data),
            })
            .then(response => response.json())
            .then(responseData => {
                // Extract necessary data from the response, adjust as needed
                const { apartment_id} = responseData;

                // Redirect to the next-door.com.ua website with the extracted parameters
                const redirectUrl = `http://next-door.com.ua/uk/flats/view/${apartment_id}`;
                window.location.replace(redirectUrl);
            })
            .catch(error => {
                console.error('Error:', error);
                // Handle errors as needed
            });
        }
        
        // Entry point
        document.addEventListener('DOMContentLoaded', function() {
            // Extract parameters from the URL
            const urlParams = getUrlParams();

            // Make API POST call with extracted parameters
            sendApiPostCall(urlParams);
        });
    </script>
</body>
</html>

